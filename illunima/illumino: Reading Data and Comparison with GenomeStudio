BiocStyle::latex()
BiocManager::install("illuminaio")
library(illuminaio)
idatFile <- system.file("extdata", "idat", "4343238080_A_Grn.idat", #complete path to one such file
+ package = "IlluminaDataTestFiles")
idat <- readIDAT(idatFile)
names(idat)
##[1] "Barcode" "Section" "ChipType" "Quants" "RunInfo" 
#Barcode and Section are the identifiers for the BeadChip can usually be found in the file name as well
#  ChipType describes the BeadArray platform this file was generated from.
# The RunInfo slot holds information about the processing performed on the array, most notably the date- to the batch effect
idatData <- idat$Quants
head(idatData)
# The CodeBinData, MeanBinData and NumGoodBeadsBinData columns are those that are reported by default in GenomeStudio and correspond 
# ProbeID, AVG_Signal and NBEADS values respectively.
#DevBinData gives the standard deviation for the bead-type and can be used the generate the BEAD_STDERR values GenomeStudio reports.

###Comparison with GenomeStudio
gsFile <- system.file("extdata", "gs", "4343238080_A_ProbeSummary.txt.gz",
+ package = "IlluminaDataTestFiles")
gStudio <- read.delim(gsFile, sep = "\t", header = TRUE)
idatData <- idatData[which(idatData[,"CodesBinData"] %in% gStudio[,"ProbeID"]),]
gStudio <- gStudio[match(idatData[,"CodesBinData"], gStudio[,"ProbeID"]),]
### Performing Comparison
par(mfrow = c(1,2))
plot(idatData[, "MeanBinData"], gStudio[, "X4343238080_A.AVG_Signal"],
+ xlab = "illuminaio", ylab = "GenomeStudio")
identical(idatData[, "MeanBinData"], gStudio[, "X4343238080_A.AVG_Signal"])
##[1] FALSE
hist(idatData[, "MeanBinData"]- gStudio[, "X4343238080_A.AVG_Signal"],
+ breaks = 100, main = "", xlab = "Difference")
